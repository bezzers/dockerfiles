FROM ubuntu

MAINTAINER Paul Beswick

# Install the desktop and other key utilities
RUN apt-get -o Acquire::ForceIPv4=true update && \
    DEBIAN_FRONTEND=noninteractive apt-get -o Acquire::ForceIPv4=true install -y \
                       lxde-core \
                       lxterminal \
                       tightvncserver \
                       wget \
#                       software-properties-common \
                       firefox \
                       default-jdk

# Download and install WebStorm                       
#RUN wget -4 -O - download.jetbrains.com/webstorm/WebStorm-10.0.4.tar.gz | tar zxf -

# Setup home environment and the startup script for vncserver
RUN useradd dev
RUN mkdir -p /home/dev/.vnc
RUN echo 123456 | vncpasswd -f > /home/dev/.vnc/passwd
RUN chmod 600 /home/dev/.vnc/passwd
#RUN echo "/etc/X11/Xsession &" >> /home/dev/.vnc/xstartup
#RUN echo "firefox &" >> /home/dev/.vnc/xstartup
#RUN chmod 755 /home/dev/.vnc/xstartup

# Install docker
#wget -4 -qO- https://get.docker.com/ | sh

# Clean up temporary files    
RUN rm -rf /var/lib/apt/lists/* && \
    rm -rf /tmp/*

# Set the user to dev
RUN chown -R dev: /home/dev
ENV USER=dev
WORKDIR /home/dev
USER dev

# Start the VNCServer
RUN vncserver :1 -geometry 1920x1080 -depth 24 && tail -F ~/.vnc/*.log
RUN firefox

# Expose the port that vnc will connect to
EXPOSE 5901
